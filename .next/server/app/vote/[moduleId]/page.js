(()=>{var e={};e.id=71,e.ids=[71],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2962:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>o,pages:()=>x,routeModule:()=>h,tree:()=>c}),r(2577),r(2029),r(5866);var a=r(3191),t=r(8716),l=r(7922),n=r.n(l),i=r(5231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);r.d(s,d);let c=["",{children:["vote",{children:["[moduleId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2577)),"/home/runner/work/rw-webapp/rw-webapp/src/app/vote/[moduleId]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,2029)),"/home/runner/work/rw-webapp/rw-webapp/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],x=["/home/runner/work/rw-webapp/rw-webapp/src/app/vote/[moduleId]/page.tsx"],o="/vote/[moduleId]/page",m={require:r,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/vote/[moduleId]/page",pathname:"/vote/[moduleId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},207:(e,s,r)=>{Promise.resolve().then(r.bind(r,9949))},9949:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>x});var a=r(326),t=r(7577),l=r(9837),n=r(5329),i=r(6137);function d({moduleId:e,moduleName:s,onVoteSubmitted:r}){let[d,c]=(0,t.useState)([]),[x,o]=(0,t.useState)(!0),[m,h]=(0,t.useState)(null),{selectedSubcategories:p,isSubmitting:u,isLoadingPreviousVote:j,hasVoted:g,existingVote:b,toggleSubcategory:N,submitVote:v,revote:f,loadPreviousVote:y}=(0,i.Lb)(),w=async()=>{try{let a=d.flatMap(e=>e.tag_subcategories||[]).filter(e=>p.includes(e.id));await v(e,s,a),r?.()}catch(e){h(e instanceof Error?e.message:"投票提交失败")}};return x?a.jsx(n.Zb,{children:a.jsx(n.aY,{className:"p-6",children:a.jsx("div",{className:"text-center",children:"正在加载标签分类..."})})}):m?a.jsx(n.Zb,{children:a.jsx(n.aY,{className:"p-6",children:a.jsx("div",{className:"text-center text-red-600",children:m})})}):g&&b?(0,a.jsxs)(n.Zb,{children:[a.jsx(n.Ol,{children:a.jsx(n.ll,{className:"text-green-600",children:"✓ 您已为此模组投票"})}),(0,a.jsxs)(n.aY,{children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"投票分类:"})," ",b.categoryName]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"选择的标签:"})," ",b.subcategoryNames.join(", ")]}),(0,a.jsxs)("p",{children:[a.jsx("strong",{children:"投票时间:"})," ",new Date(b.timestamp).toLocaleString("zh-CN")]})]}),a.jsx("div",{className:"mt-4",children:a.jsx(l.z,{variant:"outline",onClick:()=>f(e),children:"重新投票"})})]})]}):(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{children:[a.jsx(n.ll,{children:"选择标签"}),a.jsx("p",{className:"text-gray-600",children:"可以选择多个分类下的标签来标记模组中的厌女要素"}),j&&a.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"正在加载您之前的投票选择..."})]}),a.jsx(n.aY,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[d.map(e=>(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h3",{className:"font-semibold text-lg text-gray-900 border-b border-gray-200 pb-2",children:[e.name,e.description&&(0,a.jsxs)("span",{className:"text-sm font-normal text-gray-600 ml-2",children:["- ",e.description]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 pl-4",children:(e.tag_subcategories||[]).map(e=>a.jsx("button",{onClick:()=>N(e.id),className:`p-3 text-left border rounded-lg transition-colors ${p.includes(e.id)?"border-blue-500 bg-blue-50 text-blue-900":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:`w-4 h-4 rounded border mr-3 flex items-center justify-center ${p.includes(e.id)?"bg-blue-500 border-blue-500":"border-gray-300"}`,children:p.includes(e.id)&&a.jsx("span",{className:"text-white text-xs",children:"✓"})}),(0,a.jsxs)("div",{children:[a.jsx("h4",{className:"font-medium",children:e.name}),e.description&&a.jsx("p",{className:"text-sm text-gray-600",children:e.description})]})]})},e.id))})]},e.id)),a.jsx("div",{className:"flex justify-end items-center pt-4 border-t",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["已选择 ",p.length," 个标签"]}),a.jsx(l.z,{onClick:w,disabled:0===p.length||u,children:u?"提交中...":"确认提交"})]})})]})})]})}var c=r(434);function x({params:e}){let[s,r]=(0,t.useState)(null),[i,x]=(0,t.useState)(!0);return i?a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsx(n.Zb,{children:a.jsx(n.aY,{className:"p-8 text-center",children:a.jsx("div",{className:"text-gray-600",children:"正在加载模组信息..."})})})}):s?(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,a.jsxs)("nav",{className:"text-sm text-gray-600",children:[a.jsx(c.default,{href:"/",className:"hover:text-gray-900",children:"首页"}),a.jsx("span",{className:"mx-2",children:"/"}),a.jsx(c.default,{href:"/modules",className:"hover:text-gray-900",children:"模组"}),a.jsx("span",{className:"mx-2",children:"/"}),a.jsx(c.default,{href:`/modules/${s.id}`,className:"hover:text-gray-900",children:s.name}),a.jsx("span",{className:"mx-2",children:"/"}),a.jsx("span",{className:"text-gray-900",children:"投票"})]}),(0,a.jsxs)(n.Zb,{children:[a.jsx(n.Ol,{children:(0,a.jsxs)(n.ll,{children:["为 “",s.name,"” 投票"]})}),a.jsx(n.aY,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsx("div",{children:(0,a.jsxs)("p",{className:"text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"作者:"})," ",s.author,s.system&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("span",{className:"mx-2",children:"|"}),a.jsx("span",{className:"font-medium",children:"系统:"})," ",s.system]})]})}),a.jsx(c.default,{href:`/modules/${s.id}`,children:a.jsx(l.z,{variant:"outline",size:"sm",children:"查看详情"})})]})})]}),a.jsx(d,{moduleId:s.id,moduleName:s.name,onVoteSubmitted:()=>{window.location.href=`/modules/${s.id}`}}),(0,a.jsxs)(n.Zb,{children:[a.jsx(n.Ol,{children:a.jsx(n.ll,{className:"text-lg",children:"投票说明"})}),a.jsx(n.aY,{children:(0,a.jsxs)("div",{className:"space-y-3 text-sm text-gray-600",children:[a.jsx("p",{children:"• 您的投票完全匿名，其他用户无法看到您的身份"}),a.jsx("p",{children:"• 每个模组只能投票一次，但可以选择多个标签"}),a.jsx("p",{children:"• 投票记录会保存在您的浏览器本地，便于查看历史"}),a.jsx("p",{children:"• 如需修改投票，可以重新投票覆盖之前的选择"}),a.jsx("p",{children:"• 请根据模组实际内容进行客观投票"})]})})]})]}):a.jsx("div",{className:"max-w-4xl mx-auto",children:a.jsx(n.Zb,{children:(0,a.jsxs)(n.aY,{className:"p-8 text-center",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"模组不存在"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"抱歉，您查找的模组不存在或已被删除。"}),a.jsx(c.default,{href:"/modules",children:a.jsx(l.z,{children:"返回模组列表"})})]})})})}},2577:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>a});let a=(0,r(8570).createProxy)(String.raw`/home/runner/work/rw-webapp/rw-webapp/src/app/vote/[moduleId]/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),a=s.X(0,[276,471,747,122],()=>r(2962));module.exports=a})();