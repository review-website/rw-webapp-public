(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[480],{2620:function(e,s,l){Promise.resolve().then(l.bind(l,8594))},8594:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return m}});var a=l(7437),r=l(2265),t=l(7648),n=l(757),i=l(6334),c=l(3448);function d(e){let{module:s,showVoteButton:l=!0,showVoteStatus:r=!0}=e,d=(0,c.xV)(s.id);return(0,a.jsxs)(n.Zb,{className:"h-full hover:shadow-md transition-shadow border-l-4 border-l-blue-500",children:[(0,a.jsxs)(n.Ol,{className:"pb-4",children:[(0,a.jsx)(n.ll,{className:"line-clamp-2 text-lg",children:(0,a.jsx)(t.default,{href:"/modules/".concat(s.id),className:"hover:text-blue-600 transition-colors font-bold",children:s.name})}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 font-medium",children:Array.isArray(s.author)?s.author.join(", "):s.author}),s.system&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full font-medium ".concat((e=>{if(!e)return"bg-gray-100 text-gray-700";let s=e.toLowerCase();return s.includes("dnd")||s.includes("d&d")?"bg-red-100 text-red-700":s.includes("coc")||s.includes("克苏鲁")?"bg-green-100 text-green-700":s.includes("pf")||s.includes("pathfinder")?"bg-blue-100 text-blue-700":s.includes("fate")?"bg-purple-100 text-purple-700":s.includes("pbta")?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"})(s.system)),children:s.system})]})]}),(0,a.jsxs)(n.aY,{className:"flex flex-col h-full pt-0",children:[(0,a.jsxs)("div",{className:"flex-grow space-y-3",children:[s.description&&(0,a.jsx)("p",{className:"text-sm text-gray-700 line-clamp-3 leading-relaxed",children:s.description}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:(0,c.p6)(s.created_at)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4 pt-4 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[r&&(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(d?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"),children:d?"已投票":"未投票"}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[s.vote_count||0," 个标签投票"]})]}),l&&(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(t.default,{href:"/modules/".concat(s.id),children:(0,a.jsx)(i.z,{size:"sm",variant:"outline",children:"查看详情"})}),s.purchase_url&&(0,a.jsx)("a",{href:s.purchase_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors",children:"购买"}),!d&&(0,a.jsx)(t.default,{href:"/vote/".concat(s.id),children:(0,a.jsx)(i.z,{size:"sm",children:"投票"})})]})]})]})]})}function o(e){let{modules:s,pagination:l,loading:r=!1,onPageChange:t}=e;if(r)return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((e,s)=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-4"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded mb-2"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},s))})});if(0===s.length)return(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsxs)("div",{className:"text-gray-500 mb-4",children:[(0,a.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,a.jsx)("p",{className:"text-lg",children:"暂无模组数据"}),(0,a.jsx)("p",{className:"text-sm",children:"请稍后再试或联系管理员"})]})});let n=(l.page-1)*l.limit+1,c=Math.min(l.page*l.limit,l.total);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,a.jsx)(d,{module:e},e.id))}),l.totalPages>1&&(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["显示第 ",n," - ",c," 项，共 ",l.total," 项"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(i.z,{variant:"outline",size:"sm",disabled:1===l.page,onClick:()=>null==t?void 0:t(l.page-1),children:"上一页"}),(0,a.jsx)("div",{className:"flex space-x-1",children:(()=>{let e=[],s=l.page,r=l.totalPages,n=Math.max(1,s-2),c=Math.min(r,s+2);n>1&&(e.push((0,a.jsx)(i.z,{variant:1===s?"primary":"outline",size:"sm",onClick:()=>null==t?void 0:t(1),children:"1"},1)),n>2&&e.push((0,a.jsx)("span",{className:"px-2",children:"..."},"ellipsis1")));for(let l=n;l<=c;l++)e.push((0,a.jsx)(i.z,{variant:l===s?"primary":"outline",size:"sm",onClick:()=>null==t?void 0:t(l),children:l},l));return c<r&&(c<r-1&&e.push((0,a.jsx)("span",{className:"px-2",children:"..."},"ellipsis2")),e.push((0,a.jsx)(i.z,{variant:r===s?"primary":"outline",size:"sm",onClick:()=>null==t?void 0:t(r),children:r},r))),e})()}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",disabled:l.page===l.totalPages,onClick:()=>null==t?void 0:t(l.page+1),children:"下一页"})]})]})]})}var x=l(8671),u=l(2893);function m(){let{modules:e,pagination:s,loading:l,error:t,searchModules:n,goToPage:c,fetchModules:d}=(0,u.kI)();return(0,r.useEffect)(()=>{d()},[d]),(0,r.useEffect)(()=>{},[e,l,t,s]),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-yellow-700",children:"模组列表"}),(0,a.jsx)(i.z,{variant:"outline",children:"添加模组"})]}),(0,a.jsx)(x.E,{placeholder:"搜索模组、作者、系统...",onSearch:n}),t&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,a.jsxs)("p",{className:"text-red-600",children:["错误: ",t]}),(0,a.jsx)(i.z,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>{d()},children:"重试"})]}),(0,a.jsx)(o,{modules:e,pagination:s,loading:l,onPageChange:c})]})}},8671:function(e,s,l){"use strict";l.d(s,{E:function(){return n}});var a=l(7437),r=l(2265),t=l(3448);function n(e){let{placeholder:s="搜索模组、作者或标签...",onSearch:l,debounceDelay:n=300,className:i}=e,[c,d]=(0,r.useState)("");return(0,r.useEffect)(()=>{let e=setTimeout(()=>{l(c)},n);return()=>clearTimeout(e)},[c,l,n]),(0,a.jsxs)("div",{className:(0,t.cn)("relative",i),children:[(0,a.jsx)("input",{type:"text",placeholder:s,value:c,onChange:e=>d(e.target.value),className:"w-full px-4 py-2 pl-10 pr-4 text-gray-900 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}}},function(e){e.O(0,[216,764,744],function(){return e(e.s=2620)}),_N_E=e.O()}]);